# RAG System for Physical Transformation

RAG-система для работы с русскоязычным контентом в области тренинга, питания, здоровья.

## Особенности проекта

- **Ручной сбор данных**: Все данные собраны и обработаны вручную из открытых источников
- **Работа с русским языком**: Специфический контент с терминами, сленгом и сокращениями
- **Кастомные метрики оценки**: Разработаны специальные метрики для русскоязычного контента
- **Синтетические данные**: Генерация искусственных данных для оценки системы

## Техническая реализация

### Этапы работы
1. **Препроцессинг данных**
   - Очистка текстов
   - Формирование метаданных
   
2. **Векторизация и хранение**
   - Генерация эмбеддингов
   - Наполнение векторной БД

3. **Ретривер**
   - Поиск релевантных документов
   - Кастомные и классические метрики оценки (DCG Score, llm as as judge, адаптация NLI задачи)
   
4. **Генерация синтетических данных**
   - Создание пар вопрос-ответ
   - Фильтрация данных с помощью llm
   - Ручная фильтрация данных

5. **Ридер**
   - Генерация ответов
   - Кастомные и классические метрики оценки (Answer Relevancy, Answer Semantic Similarity, llm as as judge)

### Ключевые технологии
- Python 3.9+
- Transformers/HuggingFace
- Sentence-Transformers
- Chroma (Vector DB)
- LangChain

## Данные

Содержимое репозитория включает следующие данные:

- **Dataset/** - папка с исходными статьями (ручной сбор)
- **my_dataframe.xlsx** - сгенерированные пары вопрос-ответ
- **evalQA.xlsx** - отфильтрованные вручную пары вопрос-ответ
- **dataset.json** - основной датасет для оценки (вопрос, контекст, ответ модели, эталонный ответ)
- **Eval_Reader.xlsx** - результаты оценки с рассчитанными метриками
- **My_questions.xlsx** - вопросы для финального тестирования, составленные вручную

## Метрики и оценка

Разработаны кастомные метрики для:
- **Качества ретривера**
  - Нахождение релевантного чанка и его место в ранжированном списке
  - Согласованность вопроса и извлеченных документов
  - Релевантность контекста
- **Качества ридера**
  - Семантическая близость ответа и вопроса
  - Фактическая точность
  - Метрика, показывающая насколько можно ответ назвать исчерпывающим или наоборот поверхностным

Используемые модели: GigaChat, saiga_yandexgpt_8b, saiga_llama3_8b, t-tech/T-lite-it-1.0, cointegrated/rubert-tiny2, cointegrated/LaBSE-en-ru, cointegrated/rubert-base-cased-nli-threeway, colbert-ir/colbertv2.0
Подробные результаты в файле:
- `RAG_PhysicalTransformation.ipynb`
